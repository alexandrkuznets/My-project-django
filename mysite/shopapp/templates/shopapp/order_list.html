{% extends 'shopapp/base.html' %}
{% load cache %}

{%block title%}
    Orders List
{%endblock%}

{%block body %}
<h1>Orders:</h1>
{%if object_list %}
<div>
{%for order in object_list%}
    <div>
        <p><a href="{% url 'shopapp:order_details' pk=order.pk %}">Details# {{ order.pk }}</a></p>
        <p>Order by {{ current_user }}</p>
        <p>Promocode: <code>{{order.promocode}}</code></p>
        <p>Delivery address: {{order.delivery_address}}</p>
    </div>
    {% cache 300 productslist user.pk %}
    <div>
        {%for product in order.products.all%}

        <div>
            <li>
            {{product.name}} for $ {{product.price}}
            </li>
        </div>
        {%endfor%}
    </div>
    {% endcache %}
{%endfor%}
</div>
{%else%}
<h3>{{ current_user }} has no orders</h3>
{%endif%}
<div>
    <a href="{% url 'shopapp:order_create' %}">
        Create a new order
    </a>
</div>

{%endblock%}